<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout - Patel's Store</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500&family=Poppins:wght@600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="../../assets/css/style.css">
    <link rel="stylesheet" href="../../assets/css/checkout.css">
    <script defer src="../../assets/js/script.js"></script>
</head>
<body>
    <header>
        <nav class="navbar">
            <a href="../../index.html" class="logo">Patel's Store</a>
            <div class="nav-links">
                <a href="../cart/cart.html">Back to Cart</a>
            </div>
        </nav>
    </header>

    <div class="container" style="margin-top: 100px; margin-bottom: 50px;">
        <h1 class="section-title">Checkout</h1>
        
        <div class="checkout-layout">
            <form id="checkoutForm" onsubmit="handleCheckout(event)" class="checkout-form">
                
                <section class="form-section">
                    <h2><i class="fas fa-user-circle"></i> Contact Details</h2>
                    <div class="form-row">
                        <div class="form-group half">
                            <label for="name">Full Name</label>
                            <input type="text" id="name" required placeholder="John Doe">
                        </div>
                        <div class="form-group half">
                            <label for="phone">Phone Number</label>
                            <input type="tel" id="phone" required placeholder="10-digit number" pattern="[0-9]{10}">
                        </div>
                    </div>
                </section>

                <section class="form-section">
                    <h2><i class="fas fa-map-marker-alt"></i> Shipping Address</h2>
                    
                    <div class="form-group">
                        <label for="addr1">Address Line 1</label>
                        <input type="text" id="addr1" required placeholder="House No., Building Name">
                    </div>

                    <div class="form-group">
                        <label for="addr2">Street Name / Area</label>
                        <input type="text" id="addr2" required placeholder="Main Street, Locality">
                    </div>

                    <div class="form-row">
                        <div class="form-group third">
                            <label for="city">City</label>
                            <input type="text" id="city" required placeholder="City">
                        </div>
                        <div class="form-group third">
                            <label for="state">State</label>
                            <input type="text" id="state" required placeholder="State">
                        </div>
                        <div class="form-group third">
                            <label for="zip">Zip Code</label>
                            <input type="text" id="zip" required placeholder="000000" pattern="[0-9]{6}">
                        </div>
                    </div>
                </section>

                <div id="otp-section" style="display: none; margin-top: 2rem; background: rgba(0,255,136,0.05); padding: 1.5rem; border-radius: 8px; border: 1px solid var(--primary);">
                    <div class="form-group">
                        <label for="otp" style="color: var(--primary); font-weight: bold; text-align: center; display: block;">ENTER OTP</label>
                        <input type="text" id="otp" placeholder="XXXX" maxlength="4" style="letter-spacing: 10px; text-align: center; font-size: 1.5rem; width: 200px; margin: 0 auto; display: block;">
                        <small style="color: #ccc; display: block; text-align: center; margin-top: 0.5rem;">One Time Password sent to your phone</small>
                    </div>
                </div>

                <div class="form-actions" style="margin-top: 2rem;">
                    <button type="submit" id="mainButton" class="btn btn-primary" style="width: 100%; padding: 1rem; font-size: 1.1rem;">Send OTP to Verify</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        let generatedOTP = null;

        function handleCheckout(e) {
            e.preventDefault();
            const phone = document.getElementById('phone').value;
            const mainBtn = document.getElementById('mainButton');
            const otpSection = document.getElementById('otp-section');
            const otpInput = document.getElementById('otp');

            if (mainBtn.textContent.includes('Send OTP')) {
                // Simulate sending OTP
                if(phone.length !== 10) {
                    alert('Please enter a valid 10-digit phone number.');
                    return;
                }
                
                generatedOTP = Math.floor(1000 + Math.random() * 9000);
                alert(`OTP Sent to ${phone}: ${generatedOTP}`); // Simulation
                
                otpSection.style.display = 'block';
                mainBtn.textContent = 'Verify Order';
                otpInput.required = true;
                otpInput.focus();
            } else {
                // Verify OTP
                if (otpInput.value == generatedOTP) {
                    alert('Order Placed Successfully! Redirecting to Home...');
                    localStorage.removeItem('cart');
                    window.location.href = '../../index.html';
                } else {
                    alert('Invalid OTP! Please try again.');
                }
            }
        }
    </script>
</body>
</html>
